{% extends "layout.html" %}
{% block title %}Verificación SMS{% endblock %}

{% block contenido %}
<div class="min-h-[80vh] flex items-center justify-center px-4">
  <section class="w-full max-w-xl bg-white/5 backdrop-blur-sm border border-white/10 hover:border-emerald-400 rounded-xl shadow-xl p-5 space-y-5 transition duration-300 animate-fade-in-up">

    <!-- Encabezado -->
    <header class="flex items-center gap-2 text-white text-sm font-medium pb-1">
      <i data-lucide="shield-check" class="w-4 h-4 text-emerald-400"></i>
      <h2 class="text-sm tracking-wide">Verificación por SMS</h2>
    </header>

    <!-- Formulario -->
    <form id="smsForm" class="space-y-5" autocomplete="off">

      <!-- DNI y Celular -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- DNI -->
        <div>
          <label for="personId" class="block text-sm font-medium text-white">DNI</label>
          <input id="personId" maxlength="8" inputmode="numeric"
            class="w-full max-w-[6cm] bg-gray-800 border border-gray-700 px-3 py-1.5 rounded-md text-sm text-white placeholder-gray-500 outline-none focus:ring-2 focus:ring-[#4DA874]" />
          <div id="dniError" class="min-h-[1rem] text-red-500 text-xs mt-1">
            <span class="invisible">El DNI debe tener 8 dígitos.</span>
          </div>
        </div>

        <!-- Celular -->
        <div>
          <label for="phoneNumber" class="block text-sm font-medium text-white">Celular</label>
          <input id="phoneNumber" maxlength="10" inputmode="numeric"
            class="w-full max-w-[6cm] bg-gray-800 border border-gray-700 px-3 py-1.5 rounded-md text-sm text-white placeholder-gray-500 outline-none focus:ring-2 focus:ring-[#4DA874]" />
          <div id="phoneError" class="min-h-[1rem] text-red-500 text-xs mt-1">
            <span class="invisible">El celular debe tener 10 dígitos.</span>
          </div>
        </div>
      </div>

      <!-- Sucursal -->
      <div>
        <label for="merchantCode" class="block text-sm font-medium text-white mb-1">Sucursal</label>
        <select id="merchantCode"
          class="w-full max-w-full md:max-w-[20rem] bg-gray-800 mb-8 border border-gray-700 px-3 py-1.5 rounded-md text-sm text-white truncate outline-none focus:ring-2 focus:ring-[#4DA874] transition">
          <option value="">Seleccioná una opción</option>
          <option value="776">776 - Limite Deportes Alberdi</option>
          <option value="777">777 - Limite Deportes Lules</option>
          <option value="778">778 - Limite Deportes Famaillá</option>
          <option value="779">779 - Limite Deportes Alderetes</option>
          <option value="781">781 - Limite Deportes Banda de Río Salí</option>
        </select>
      </div>

<!-- Código generado -->
<div class="bg-gray-900 border border-gray-700 rounded-md px-4 py-3 flex items-center justify-between">
  <div class="w-full text-center">
    <p class="text-xs text-gray-400 mb-1">Código generado</p>
    <div id="codeDisplay" class="text-xl font-mono font-semibold tracking-widest text-sky-400">----</div>
  </div>
  <button id="generateBtn" type="button"
    class="group p-2 rounded-full bg-[#4DA874] hover:bg-emerald-600 text-white shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-emerald-300">
    <i id="rotateIcon" data-lucide="rotate-cw"
       class="w-5 h-5 text-white group-hover:rotate-180 transition-transform duration-300 ease-in-out"></i>
  </button>
</div>



      <!-- Último mensaje -->
      <div id="lastMessageContainer"
        class="bg-gray-900 border border-gray-700 rounded-md px-4 py-3 text-sm text-white font-mono whitespace-pre-line transition flex items-start gap-2">
        <i id="statusIcon" data-lucide="info" class="w-5 h-5 mt-0.5 text-white/70 shrink-0"></i>
        <div id="lastMessage">No hay mensajes aún</div>
      </div>

      <!-- Botones -->
      <div class="text-center flex justify-center gap-4">
        <input type="hidden" id="verificationCode" />
        <button id="submitBtn" type="submit" disabled
          class="px-3 py-1.5 text-sm bg-[#4DA874] hover:bg-emerald-600 text-white font-semibold rounded-md transition disabled:opacity-40 disabled:cursor-not-allowed inline-flex items-center justify-center min-w-[110px]">
          <i data-lucide="send" class="w-4 h-4 mr-1.5 -ml-0.5 text-white/90"></i>
          <span id="submitText">Enviar</span>
          <svg id="loader" class="hidden animate-spin w-4 h-4 ml-1.5 text-white"
            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" />
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z" />
          </svg>
        </button>

        <button id="cancelBtn" type="button"
          class="px-3 py-1.5 text-sm text-white font-medium rounded-md inline-flex items-center justify-center min-w-[110px] transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-white/30"
          style="background-color: #f02828;"
          onmouseover="this.style.backgroundColor='#f32d2d';"
          onmouseout="this.style.backgroundColor='#f04a4a';">
          <i data-lucide="x-circle" class="w-4 h-4 mr-1.5 -ml-0.5 text-white/90"></i>
          <span>Cancelar</span>
        </button>
      </div>
    </form>

  </section>
</div>
{% endblock %}

{% block scripts %}
  <script src="/static/js/verificarSms.js"></script>
  <script>lucide.createIcons();</script>
{% endblock %}